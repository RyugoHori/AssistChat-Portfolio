# このプロジェクトについて

## 自己紹介

21歳、製造業の設備保全担当です。昼勤で担当課の前工程ライン全て（8ライン）を担当しています。
本務の傍らICT班を兼務しており、プログラミングは高校時代からの独学とITスタートアップ副業での経験や社内チーム開発経験から学びました。

---

## なぜこのアプリを作ったか

### 現場で感じていた課題

工場で設備保全をやっていると、夜間に故障が発生することがあります。
私は昼勤なので、夜間の故障は3交代勤務の保全班が対応します。

**ここに問題がありました：**

| 対象 | 課題 |
|------|------|
| 3交代班 | 全課の全ラインを横断的に担当するため、特定設備の知見が浅い |
| 若手保全マン | 初めて経験する故障パターンに対応できない |
| ベテラン | 課を異動すると、その課の過去の故障履歴や癖を知らない |
| データ活用 | 故障対応記録など毎度作成しているが、いざ故障発生した際に過去の記録表を見る文化が無く上手く活用されていないと感じた。(システム上類似故障に絞って探すのが困難なため) |


設備停止が120分を超えると「重大故障」判定になり、なぜなぜ分析や再発防止対策などの対応が発生します。

**過去に何度もあったケース：**

> 【ベテラン不在時若手のみで突発故障対応】 → 若手の知見では原因究明に時間を要す → 気が付いたら設備停止時間が長くなってしまい生産性低下。→ベテランならすぐ原因分かってたのに...

> 【夜間に故障発生】 → 3交代班が原因わからず苦戦 → 120分超えて重大故障 → 翌日調べたら「これ前にも同じ現象起きてるじゃん。過去記録の通りにやれば5分で直せたのに...」

過去の故障記録を素早く検索できれば、こういったケースを防げる。
これがこのアプリを作ろうと思ったきっかけです。

### 個人的なモチベーション

正直なところ、現場課題の解決だけじゃなく：

- ITスキルを磨いて、IT人材としての価値を高めたい
- ITスタートアップではRAG開発案件にも携わっていたが、LangChainの抽象化が多く、自分自身ロジックを深く理解できていなかった
- 個人開発でじっくり仕組みを根本から理解してみたいという好奇心

---

## 技術選定：なぜローカル完結なのか

### 最重要の制約

このプロジェクトは、**会社の正式なプロジェクトではなく、個人の現場改善活動**としてスタートしました。

| 状況 | 制約 |
|------|------|
| 会社方針でないプロジェクト | 機密データを外部サービスに送信できない |
| 製造業の保全記録 | 設備情報、故障パターンは機密性が高い |
| 個人の裁量で進行 | 会社承認なしに外部サービス契約は不可 |

### 結果：全ての技術をローカル完結に

| 機能 | 選定技術 | 外部API依存 |
|------|----------|-------------|
| Embedding | sentence-transformers | ❌ なし |
| ベクトル検索 | FAISS | ❌ なし |
| キーワード検索 | rank-bm25 | ❌ なし |
| Re-ranker | Cross-Encoder | ❌ なし |
| 形態素解析 | MeCab + unidic-lite | ❌ なし |

**外部サービス依存は一切ない。データが社外に出ることはありません。**

情報システム部の方々にローカル開発の技術選定について認可を得たのちに開発を開始しました。

---

## 開発の経緯

### Phase 1: プロトタイプ（2025年2月〜3月）

最初はシンプルなPythonスクリプトとStreamlitで作成。

**直面した課題：**
- 専門用語（「チャッキングミス」「リミットスイッチ」等）の検索精度が低い
- エラーコード「E-1234」のような完全一致が必要なケースに対応できない

**学び：** ベクトル検索だけでは不十分。キーワード検索との組み合わせが必要。

### Phase 2: ハイブリッド検索の導入（2025年3月〜4月）

| 要件 | 選定技術 | 選定理由 |
|------|----------|----------|
| ベクトル検索 | FAISS | 高速、ローカル実行可能、Meta開発で実績豊富 |
| キーワード検索 | BM25 | 軽量、Pythonネイティブ |
| 結果統合 | RRF | スコア正規化不要、実装シンプル |
| Re-ranking | Cross-Encoder | 精度大幅向上（MRR +29%） |

**なぜクラウド系ベクトルDB(Pinecone/Weaviate)を使わなかったか：**
- クラウド依存 → 機密データを外部に送れない制約に抵触
- FAISSで1万件程度は余裕で対応可能

**精度評価結果（実データ1万件での実績）：**

| 手法 | MRR@5 | Recall@5 | 改善率 |
|------|-------|----------|--------|
| Dense (FAISS) のみ | 0.48 | 0.62 | baseline |
| Sparse (BM25) のみ | 0.45 | 0.58 | -6% |
| Hybrid (RRF) | 0.67 | 0.78 | **+40%** |
| Hybrid + Re-ranker | **0.81** | **0.89** | **+69%** |
> 評価スクリプトは `tools/evaluation/` に格納しています。
### Phase 3: Webアプリ化（2025年4月〜6月）

| レイヤー | 技術 | 選定理由 |
|----------|------|----------|
| Frontend | Next.js 14 | 採用実績多、優れたDevEx |
| UI | shadcn/ui | カスタマイズ性、Tailwindとの相性　見た目が好き |
| Backend | FastAPI | 型安全、OpenAPI自動生成、Pythonエコシステムとの親和性 |
| インフラ | Docker Compose | 環境統一、一発起動 |



---

## プロジェクトのその後

### 時系列

```
個人の現場改善として開発開始
    ↓
仮運用開始、各保全担当者を巻き込み実際に使用してもらう
    ↓
ICT班に認知される
    ↓
会社方針で正式にRAG開発が決定
  → 全国工場でクラウドデータ分析基盤【Databricks】統一の方針
    ↓
統一化のためこのアプリは正式採用されず...（少し悲しい）
    ↓
しかし知見が評価され、ICT班のRAG開発担当に任命
    ↓
現在Databricksで開発中、ETLパイプライン等実装中
```



---

## このプロジェクトで得たもの

### 技術的な成長

- RAGの仕組みを根本から理解できた
- ハイブリッド検索、Re-ranking、RRFなどの概念を実装レベルで習得
- ITスタートアップの際には他メンバーの裁量で行われていた技術選定然り、アーキテクチャ設計、CI/CD、Dockerなどの開発プラクティスを自身で体験



### 学んだこと

> **「周りを巻き込むこと」の重要性**
>
> ・情報システム部門の方と細かく連絡を取ることで、セキュリティを担保しながら検証できた
>
>・"完璧を目指す"より"まず動くものを見せる"方がフィードバックを得やすく、
>他課や三交代班など実際のユーザーから密にフィードバックを得ることで精度指標（MRR）だけでなく、いかに現場で"使いやすいか"という視点を常に持って開発できた
>

